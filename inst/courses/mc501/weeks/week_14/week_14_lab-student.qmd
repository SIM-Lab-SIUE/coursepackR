---
title: "Week 14: Making Inferences"
subtitle: "The Leap from Sample to Population"
format: html
editor: visual
---

> **Required Citation:**
> Pew Research Center, "ATP W144: Politics and News on Social Media Platforms."
> Pew Research Center, Washington, D.C. (March 2024).
>
> **Required Disclaimer:**
> Pew Research Center bears no responsibility for the analyses or interpretations of the data presented here. The opinions expressed herein, including any implications for policy, are those of the author and not of Pew Research Center.

## Introduction

This lab follows **Chapter 14: Making Inferences**. Our goal is to use our sample data to make claims about the larger population. We will use the `w144_clean.csv` file we created, which includes our `fb_news_diversity_score`.

We will:
1.  State a **Null Hypothesis ($H_0$)** and **Research Hypothesis ($H_1$)**.
2.  Choose the correct statistical test.
3.  Evaluate the **p-value** against our alpha level ($\alpha = 0.05$).
4.  Interpret the result and write it up.

## 1. Setup: Load Packages and Data

We load `tidyverse` and `broom`. `broom` is a *vital* package that cleans up the messy output from R's statistical tests into tidy tables.

```{r load-packages-data, message=FALSE, warning=FALSE}
library(tidyverse)
library(broom) # For tidy()
library(mccoursepack)

# Load the excerpted Pew data from our course package
data("w144_excerpt")
w144_clean <- w144_excerpt
```

## 2. Test of Association (Categorical): Chi-Square

**Research Question:** Is there a relationship between a respondent's political party and their education level?

* **$H_0$:** There is no association between `party_factor` and `education_factor`.
* **$H_1$:** There is an association between `party_factor` and `education_factor`.
* **Test:** Chi-Square ($\chi^2$) Test of Independence.

```{r test-chisq, warning=FALSE}
# 1. Create a contingency table
party_ed_table <- table(w144_clean$party_factor, w144_clean$education_factor)
print(party_ed_table)

# 2. Run the test and use tidy() to clean the output
chi_results <- chisq.test(party_ed_table)
tidy(chi_results)
```

**Interpretation:**
* Look at the `p.value`. Is it less than 0.05?
* If yes, we **reject the null hypothesis**.
* **Write-up:** "A chi-square test revealed a significant association between political party and education level, $\chi^2$(df) = [statistic], $p$ < .001."

## 3. Test of Association (Continuous): Correlation

**Research Question:** Is a person's political ideology related to their Facebook news diversity score?

* **$H_0$:** There is no correlation between `ideology` and `fb_news_diversity_score` ($r = 0$).
* **$H_1$:** There is a correlation between `ideology` and `fb_news_diversity_score` ($r \neq 0$).
* **Test:** Pearson's Correlation ($r$).

```{r test-cor}
# Note: `ideology` is numeric (1-5), as is our composite score.
cor_results <- cor.test(w144_clean$ideology, w144_clean$fb_news_diversity_score)
tidy(cor_results)
```

**Interpretation:**
* Look at the `estimate` (this is the effect size, $r$). Is it positive or negative? (Positive means as ideology becomes more liberal (5), the score increases).
* Look at the `p.value`. Is it < 0.05?
* **Write-up:** "A Pearson's correlation found a [positive/negative], [weak/moderate/strong] and statistically significant relationship between ideology and Facebook news diversity, $r$([df]) = [estimate], $p$ = [p.value]."

## 4. Test of Difference (2 Groups): t-test

**Research Question:** Is there a difference in Facebook news diversity scores between men and women?

* **$H_0$:** The mean `fb_news_diversity_score` is the same for men and women.
* **$H_1$:** The mean `fb_news_diversity_score` is different for men and women.
* **Test:** Independent Samples t-test.

```{r test-ttest}
# 1. Run the t-test. We use the formula: y ~ x
# Note: The `gender_factor` has only two levels, "Man" and "Woman".
ttest_results <- t.test(fb_news_diversity_score ~ gender_factor, data = w144_clean)
tidy(ttest_results)
```

**Interpretation:**
* Look at `estimate1` (mean for Man) and `estimate2` (mean for Woman).
* Look at the `p.value`. Is it < 0.05?
* **Write-up:** "An independent samples t-test found that [Men] ($M$ = [estimate1]) had [significantly different/no significant difference in] Facebook news diversity scores compared to [Women] ($M$ = [estimate2]), $t$([parameter]) = [statistic], $p$ = [p.value]."

## 5. Test of Difference (3+ Groups): ANOVA

**Research Question:** Does Facebook news diversity score differ across political parties?

* **$H_0$:** The mean `fb_news_diversity_score` is the same for all party groups.
* **$H_1$:** At least one party group has a different mean score.
* **Test:** Analysis of Variance (ANOVA).

```{r test-anova}
# 1. Run the ANOVA (y ~ x)
# Our `party_factor` variable has 4 levels, so ANOVA is appropriate.
anova_results <- aov(fb_news_diversity_score ~ party_factor, data = w144_clean)
tidy(anova_results)

# 2. If p < .05, run a Post-Hoc test (Tukey's) to see *which* groups differ
# We only do this if the main ANOVA is significant!
tidy(TukeyHSD(anova_results))
```

**Interpretation:**
* Look at the `p.value` from the `tidy(anova_results)` table (the row for `party_factor`). If $p < .05$, the test is significant.
* If significant, look at the `TukeyHSD` results. Any row with an `adj.p.value` < 0.05 represents a significant difference between those two specific groups.
* **Write-up:** "A one-way ANOVA revealed a significant effect of political party on Facebook news diversity scores, $F$([df], [df.residual]) = [statistic], $p$ = [p.value]. A Tukey post-hoc test showed that [Group 1] ($M$ = ?) was significantly different from [Group 2] ($M$ = ?)."

